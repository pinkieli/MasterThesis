\chapter{结构动响应数值算法研究现状}

对于结构动力学运动方程(\ref{eq:DyEq})
\begin{equation}
	M\ddot{U}(t)+C\dot{U}(t)+KU(t)=F(t)\label{eq:DyEq}
\end{equation}
带有合适的初值条件的求解。最常用的就是直接积分法，该方法的要求运动方程(\ref{eq:DyEq})在离散的时刻精确满足。同时假定位移和速度的更新方程，利用离散时刻的平衡方程求得对应时刻的加速度，进而求得速度和位移。特别地，自从Newmark-$\beta$算法\cite{Newmark1959}、Wilson-$\theta$法\cite{Wilson1968}和Houbolt法\cite{Chopra2011}等直接积分法提出以来，许多的研究学者在此之后基于各种原理提出了许多性能优良的积分算法。

\section{直接积分法}
\subsection{BEF算法}
清华大学的刘天云副研究员给出了一个利用向后Euler公式(BEF)求解结构动响应\cite{Liu2012}。该算法具有
\begin{itemize}
\item[\ddag] 易求解性。非常方便的运用到线性系统和非线性系统的求解中。
\item[\ddag] 不涉及额外的算法参数选择，如拉格朗日乘子。
\item[\ddag] 单解性。在离散的时刻具有对称的有效刚度矩阵。
\item[\ddag] 易编程。非常容易的编程到已有的软件中。
\end{itemize}
其算法格式如下
\begin{align}
{^{t+\Delta t}\!U}&={^t\!\dot{U}}+\frac{\Delta t^2}{2}{^{t+\Delta t}\!\ddot{U}}\\
{^{t+\Delta t}\!\dot{U}}&=\frac{3}{2\Delta t}{^{t+\Delta t}\!U}-\frac{2}{\Delta t}{^t\!U}+\frac{1}{2\Delta t}{^{t-\Delta t}\!U}
\end{align}
且在$t+\Delta t$时刻满足平衡方程(\ref{eq:DyEq})，即
\begin{equation}
	M{^{t+\Delta t}\!\ddot{U}}+C{^{t+\Delta t}\!\dot{U}}+K{^{t+\Delta t}\!U}={^{t+\Delta t}\!F}\label{eq:batheDyEq1}
\end{equation}
在第一个时间步长内，需要额外的速度启动机制
\begin{equation}
{^{\Delta t}\!\dot{U}}=\frac{3}{2\Delta t}({^{\Delta t}\!U}-{^0\!U})-\frac{1}{2}{^0\!\dot{U}}+\frac{\Delta t}{4}{^{0}\!\ddot{U}}
\end{equation}
\subsection{BADF-TR算法}
后来，刘天云副研究员在2013年通过考虑Newmark算法家族\cite{Newmark1959}中的参数$\beta=\gamma=1/2$来分析得到了一个新的保辛算法(BADF-TR算法)\cite{Liu2013}。该算法仍然拥有前面提及的BEF算法的优点，同时还是自启动的。其算法格式如下
\begin{align}
{^{t+\Delta t}\!U}&={^t\!U}+{^{t}\!\dot{U}}\Delta t+\frac{\Delta t^2}{2}{^{t+\Delta t}\!\ddot{U}}\label{eq:liu6}\\
{^{t+\Delta t}\!\dot{U}}&={^t\!\dot{U}}+\frac{\Delta t}{2}({^t\!\ddot{U}}+{^{t+\Delta t}\!\ddot{U}})\label{eq:liu12}
\end{align}
更新公式(\ref{eq:liu6})是利用了二阶的向后加速度公式(Backward Acceleration Formulas)，而(\ref{eq:liu12})则是利用Trapezoidal规则。

其实，参数$\beta=\gamma=\frac{1}{2}$早被Lee所推导出来求解拟线性双曲微分方程\cite{Zienkiewicz1977a,Lees1966}。

\subsection{GCD-BDF2算法}
清华大学的李庆斌等人\cite{Zhang2015a}利用广义中心差分法和三点向后微分公式结合（其速度更新公式利用三点向后微分公式而加速度则利用广义中心差分法），提出了一个新的复合型算法。该算法是二阶收敛的、无条件稳定的单解算法。而且每一个时间步长内只需要求解一次非线性方程组，其计算量较Trapezoidal规则相当。

在$t+\Delta t$时刻的加速度${^{t+\Delta t}\!\ddot{U}}$可以由向前Euler差分公式得到
\begin{equation}
{^{t+\Delta t}\!\ddot{U}}={^t\!\ddot{U}}+\Delta t{^{t}\!U^{(3)}}\label{eq:Zhang6}
\end{equation}
其中二阶、三阶段微分表达式则利用中心差分公式得到
\begin{equation}
{^t\!\ddot{U}}=\frac{{^{t+\Delta t}\!U}-2{^t\!U}+{^{t-\Delta t}\!U}}{\Delta t^2},\qquad {^{t}\!U^{(3)}}=\frac{{^{t+\Delta t}\!\dot{U}}-2{^t\!\dot{U}}+{^{t-\Delta t}\!\dot{U}}}{\Delta t^2}\label{eq:Zhang7}
\end{equation}
将公式(\ref{eq:Zhang7})带入到(\ref{eq:Zhang6})可以得到其加速度${^{t+\Delta t}\!\ddot{U}}$的更新公式
\begin{equation}
{^{t+\Delta t}\!\ddot{U}}=\frac{{^{t+\Delta t}\!U}-2{^t\!U}+{^{t-\Delta t}\!U}}{\Delta t^2}+\frac{{^{t+\Delta t}\!\dot{U}}-2{^t\!\dot{U}}+{^{t-\Delta t}\!\dot{U}}}{\Delta t}\label{eq:ZhangA}
\end{equation}
同时，其速度${^{t+\Delta t}\!\dot{U}}$的更新公式则利用三点向后微分公式
\begin{equation}
{^{t+\Delta t}\!\dot{U}}=\frac{1}{2\Delta t}\left(3{^{t+\Delta t}\!U}-4{^t\!U}+{^{t-\Delta t}\!U}\right)\label{eq:ZhangV}
\end{equation}

于是，公式(\ref{eq:ZhangA})-(\ref{eq:ZhangV})结合在$t+\Delta t$时刻的平衡方程，就得到了GCD-BDF2算法。

\subsection{Soares-Jr型算法}
Soares Jr近来提出了一些耗散性的时间积分算法\cite{Jr2014,Soares2014,Grosseholz2015,SoaresJr2016,Soares2015,Soares2016a,SoaresJr2016a}，其特点是算法参数依赖于系统的频率值。
\subsubsection{SJ算法格式1\cite{SoaresJr2016}}
考虑带有合适初值问题的运动方程(\ref{eq:DyEq})的数值积分算法时，在时间步长$\Delta t$时积分则有
\begin{equation}
M\int_{t-\Delta t/2}^{t+\Delta t/2}\ddot{U}(\tau)d\tau+C\int_{t-\Delta t/2}^{t+\Delta t/2}\dot{U}(\tau)d\tau+K\int_{t-\Delta t/2}^{t+\Delta t/2}{U}(\tau)d\tau=\int_{t-\Delta t/2}^{t+\Delta t/2}F(\tau)d\tau\label{eq:SJAMM3}
\end{equation}
其中，等式左边的积分可近似为
\begin{subequations}
\begin{align}
\int_{t-\Delta t/2}^{t+\Delta t/2}\ddot{U}(\tau)d\tau&\approx{^{t+\Delta t}\!\dot{U}}-{^{t}\!\dot{U}}\qquad \int_{t-\Delta t/2}^{t+\Delta t/2}\dot{U}(\tau)d\tau\approx{^{t+\Delta t}\!{U}}-{^{t}\!{U}}\\
\int_{t-\Delta t/2}^{t+\Delta t/2}{U}(\tau)d\tau&\approx{^t\!U}\Delta t+\frac{\Delta t^2}{2}(\alpha_1{^{t+\Delta t}\!\dot{U}}+\alpha_2{^{t}\!\dot{U}})\label{eq:SJAMM43}
\end{align}\label{eq:SJAMM4}
\end{subequations}
而右边的外力荷载积分项可以使用数值积分方法计算，如Trapezoidal积分规则和Simpson积分规则等\cite{Quarteroni2010}。

在$t+\Delta t$时刻的位移使用Trapezoidal规则\cite{book:dover}计算，即
\begin{equation}
{^{t+\Delta t}\!U}={^t\!U}+\frac{\Delta t}{2}({^{t+\Delta t}\!\dot{U}}+{^{t}\!\dot{U}})\label{eq:SJAMM5}
\end{equation}

将等式(\ref{eq:SJAMM4})-(\ref{eq:SJAMM5})带入到(\ref{eq:SJAMM3})可得
\begin{equation}
[M+\frac{1}{2}\Delta tC+\frac{1}{2}\alpha_1\Delta t^2K]{^{t+\Delta t}\!\dot{U}}=[M{^t\!\dot{U}}-\frac{1}{2}\Delta tC{^t\!\dot{U}}-K(\Delta t{^t\!U}+\frac{1}{2}\alpha_2\Delta t^2{^t\!\dot{U}})]+{_{F_i}\!\Im}\label{eq:SJAMM6}
\end{equation}
其中，${_{F_i}\!\Im}$表示等式(\ref{eq:SJAMM3})右端的荷载积分项。于是在$t+\Delta t$时刻的速度可以通过求解等式(\ref{eq:SJAMM6})获得。结合等式(\ref{eq:SJAMM5})，一个完整的直接积分格式可以被获得。算法参数$\alpha_1,\alpha_2$控制着算法的各项数值性能，其选取规则如下
\begin{equation}
\alpha_1=\frac12+\frac{3}{2}\tanh(a\omega\Delta t)\qquad\alpha_2=2\sqrt{2\alpha_1}-\alpha_1-1
\end{equation}
其中$a$为控制参数，$\omega$为系统的固有频率。在求解多自由度系统时，由$\omega_i=\sqrt{K_{ii}/M_{ii}}$近似求解，此时的参数$\alpha_i,i=1,2$是两个向量。

特别地，算法的耗散能力的大小与控制参数$a$成正比，当$a=0$且荷载积分项选择适当的积分规则时，上述算法将退化为标准的常平均加速度算法\cite{book:dover}。当$a\ge0$时，算法实现无条件稳定性。该算法的特点是
\begin{itemize}
\item[\ddag] 真正意义上的自启动算法。省略了求解加速度响应值。
\item[\ddag] 基于速度和位移格式的单步单解算法。
\item[\ddag] 实现无条件稳定性(L-稳定)。
\item[\ddag] 实现二阶精度
\item[\ddag] 尽管理论分析得出在位移上存在超调，但其数值阻尼将其完全滤去。故实际上，该算法没有超调现象发生。
\item[\ddag] 在中频段，数值阻尼大小可控。
\end{itemize}

文\inlinecite{Soares2016a}中着重分析了该算法的一个条件稳定子域
\begin{equation}
(\alpha_1,\alpha_2)\in\{0<\alpha_1<\frac{1}{2},\alpha_2\ge1-\alpha_1\}
\end{equation}
当$\alpha_2=1-\alpha_1$时，该条件稳定稳定算法没有数值阻尼，而对于$\alpha_2>1-\alpha_1$时，数值阻尼则被引入。具体的参数$\alpha_1,\alpha_2$的取值建议为
\begin{equation}
\alpha_1=\frac{1}{2}\tanh(\frac{1}{4}\Omega_{max})\qquad\left\{
\begin{aligned}
\alpha_2&=1-\alpha_1\ \text{无数值阻尼}\\
\alpha_2&=2\sqrt{2\alpha_1+(2/\Omega_s)^2}-(1+\alpha_1)\ \text{最大数值阻尼}
\end{aligned}\right.
\end{equation}
其中，$\Omega_{max},\Omega_s$分别为系统的无量纲最大采样频率和谱半径分岔点处的采样频率（此时谱半径实现最大化）。

\subsubsection{SJ算法格式2\cite{Jr2014}}
若在$t+\Delta t$时刻的位移计算公式(\ref{eq:SJAMM5})改写成一般性的计算格式
\begin{equation}
{^{t+\Delta t}\!U}={^t\!U}+\delta_1{^{t+\Delta t}\!\dot{U}}+\delta_2{^{t}\!\dot{U}}
\end{equation}
则计算$t+\Delta t$时刻的速度公式变为
\begin{equation}
[M+\delta_1\Delta tC+\frac{1}{2}\alpha_1\Delta t^2K]{^{t+\Delta t}\!\dot{U}}=[M{^t\!\dot{U}}-\delta_2\Delta tC{^t\!\dot{U}}-K(\Delta t{^t\!U}+\frac{1}{2}\alpha_2\Delta t^2{^t\!\dot{U}})]+{_{F_i}\!\Im}
\end{equation}
其中${_{F_i}\!\Im}$仍表示等式(\ref{eq:SJAMM3})右端的荷载积分项。其算法参数$\alpha_i,\delta_i,i = 1,2$可取值为
\begin{itemize}
\item[$\clubsuit$] \textbf{显式算法}
\begin{equation}
\delta_1 = \frac12+d\omega\Delta t\quad\alpha_1=0\quad\delta_2=1-\delta_1\quad\alpha_2=2\delta_2
\end{equation}
\item[$\clubsuit$] \textbf{隐式算法}
\begin{equation}
\left\{
\begin{aligned}
\delta_1 &= \frac12+d\omega\Delta t\quad\alpha_1=\frac12+\frac{3}{2}\tanh(a\omega\Delta t)\\
\delta_2& =\frac12-d\omega\Delta t\quad\alpha_2=2\sqrt{2\alpha_1}-\alpha_1-2\delta_1
\end{aligned}\right.
\end{equation}
\end{itemize}
其中，参数$d,a$控制算法的数值特性，如周期误差、中频段的数值阻尼等。该算法的特点类似于SJ算法格式1。

\subsubsection{SJ算法格式3\cite{Soares2015}}
当SJ算法格式1\cite{SoaresJr2016}中的公式(\ref{eq:SJAMM43})修改为
\begin{equation}
\int_{t-\Delta t/2}^{t+\Delta t/2}{U}(\tau)d\tau\approx{^t\!U}\Delta t+\frac{\Delta t^2}{2}[\alpha{^{t+\Delta t}\!\dot{U}}+(1-\alpha){^{t}\!\dot{U}}]
\end{equation}
其余计算格式不变，此时在$t+\Delta t$时刻的速度计算方程为
\begin{equation}
[M+\frac{1}{2}\Delta tC+\frac{1}{2}\alpha\Delta t^2K]{^{t+\Delta t}\!\dot{U}}=[M{^t\!\dot{U}}-\frac{1}{2}\Delta tC{^t\!\dot{U}}-K(\Delta t{^t\!U}+\frac{1}{2}(1-\alpha)\Delta t^2{^t\!\dot{U}})]+{_{F_i}\!\Im}
\end{equation}
同理，其${_{F_i}\!\Im}$表示等式(\ref{eq:SJAMM3})右端的荷载积分项。其自适应参数$\alpha$取值为
\begin{equation}
\alpha=\frac{1}{2}\tanh(a\omega\Delta t),\quad a\ge0.24567002
\end{equation}

\subsubsection{SJ算法格式4\cite{Soares2014}}
当在公式(\ref{eq:SJAMM43})中取$\alpha_1=0$时，SJ算法格式1\cite{SoaresJr2016}将退化为一个显式的直接积分格式\cite{Soares2014}。同时令其余计算格式不变，此时在$t+\Delta t$时刻的速度计算方程为
\begin{equation}
[M+\frac{1}{2}\Delta tC]{^{t+\Delta t}\!\dot{U}}=[M{^t\!\dot{U}}-\frac{1}{2}\Delta tC{^t\!\dot{U}}-K(\Delta t{^t\!U}+\frac{1}{2}\alpha_2\Delta t^2{^t\!\dot{U}})]+{_{F_i}\!\Im}
\end{equation}
${_{F_i}\!\Im}$依旧表示等式(\ref{eq:SJAMM3})右端的荷载积分项。其自适应参数$\alpha_2$取值为
\begin{equation}
\alpha_2=1+a\omega\Delta t
\end{equation}

当$\alpha_2\ge1$时，算法是条件稳定的；否则，算法是无条件不稳定的。当$\alpha_2=1$时，算法具有中心差分法的数值特性；当$\alpha_2>1$时，算法引入数值阻尼，此时基于稳定性理论的临界采样频率为
\begin{equation}
\Omega_c=\frac{2}{\sqrt{\alpha_2}}
\end{equation}
而谱半径分岔点处的采样频率为
\begin{equation}
\Omega_b=\frac{4}{1+\alpha_2}
\end{equation}
一般情况下，参数$\alpha_2$建议取值范围在$1\le\alpha_2\le3$。

\subsubsection{SJ算法格式4\cite{SoaresJr2016a}}
Soares Jr基于前面提出的SJ算法格式2\cite{Jr2014}，提出了一个新的显式积分算法\cite{SoaresJr2016a}。针对无阻尼矩阵情况($C=0$)，该算法格式为
\begin{align}
 M{^{t+\Delta t}\!\dot{U}}&={_{F_i}\!\Im}+M{^t\!\dot{U}}-K({^t\!U}\Delta t+\frac12{^t\!\dot{U}}\Delta t^2)\\
 M{^{t+\Delta t}\!U}&=M[{^t\!U}+\frac{\Delta t}{2}({^t\!\dot{U}}+{^{t+\Delta t}\!\dot{U}})]-K[(\beta b_1b_2){^t\!\dot{U}}\Delta t^3+(\frac{1}{16}+\beta b_1){^{t+\Delta t}\!\dot{U}}\Delta t^3]
\end{align}
其中，${_{F_i}\!\Im}$则为前述提及的荷载积分项。同时参数$\beta,b_1$和$b_2$取值分别为
\begin{equation}
b_1=8.567\cdot10^{-3}\qquad b_2=8.590\cdot10^{-1}\qquad 0\le\beta\le1
\end{equation}
此时，算法的谱半径曲线光滑，无凸起。而参数$\beta=0$对于无数值阻尼情形，其基于稳定性理论的采样频率极限为$\Omega_c=4$；而当$\beta=1$时，谱半径在分岔点达到最小值$\rho_b=0$，其最大采样频率为$\Omega_c\approx3.571$。

该算法的优点主要是
\begin{itemize}
\item[\ddag] 真正意义上的自启动，不需要任何求解加速度的机制。
\item[\ddag] 算法简单，求解方便且实现二阶精度。
\item[\ddag] 显式的条件稳定稳定算法，其稳定域是中心差分法的二倍，但计算量几乎相当。
\item[\ddag] 实现数值阻尼的可控性(由参数$\beta\in[0,1]$控制)。
\end{itemize}

\subsubsection{稳定化的中心差分法}
Gro\ss eholz和Soares Jr等人\cite{Grosseholz2015}利用一个依赖于结构的参数引入人工质量矩阵进而将传统的中心差分法\cite{Chopra2011}实现了无条件稳定。该算法针对单自由度无阻尼自由振动系统
\begin{equation}
\ddot{U}(t)+\omega^2U(t)=0
\end{equation}
引入依赖于结构的参数后
\begin{equation}
(1+a(\Delta t\omega)^2)\ddot{U}(t)+\omega^2U(t)=0
\end{equation}
对$\ddot{U}(t)$使用二阶中心差分后并带入上式得
\begin{equation}
{^{t+\Delta t}\!U}=\left(2-\frac{(\Delta t\omega)^2}{1+a(\Delta t\omega)^2}\right){^t\!U}-{^{t-\Delta t}\!U}
\end{equation}
如果需要，其速度和加速度仍使用传统的中心差分法求解格式\cite{Chopra2011}计算。

参数$a$满足$0\le a\le0.25$；当$a=0$时，该稳定化的中心差分法退化为传统的中心差分法\cite{Chopra2011}；当$a=0.25$时，该方法与常平均加速度算法\cite{book:dover}是谱等价的。数值实验表明，引进的稳定化中心差分法精度较传统的中心差分法和常平均加速度算法高。但引入的技术也需要事先对待分析的系统的频率进行估计和计算，尤其是求解大规模多自由度系统中，可能是一件比较麻烦的事情。



\section{预测-校正算法}


\section{结构依赖型直接积分法}

\section{复合型子步隐式算法}
Tarnow和Simo在1994年提出了一个子步复合方法\cite{Tarnow1994}，将一般的二阶直接积分法的精度提高到四阶。在该方法中，一个时间步长内需要三次的子步计算。同时原来的二阶方法的稳定、守恒性质仍保持不变。需要注意的是，当该方法运用到二阶的Newmark-$\beta$方法\cite{Newmark1959}时，导出的高阶算法是没有数值耗散的。为了引入高频耗散特性，需要对求得的响应进行一定的技术处理，如后处理的滤波技术\cite{Fung1998}。后来，又有许多研究学者进行进一步的探索，发展了许多可靠优质的直接积分算法。
\subsection{TR-BDF2算法}
麻省理工的K.J. Bathe教授在2005年提出了一个两子步算法\cite{Bathe2005,Bathe2007,Bathe2012a}。假设在$t$时刻的状态量，即$^{t}\!U,{^{t}\!\dot{U}},{^{t}\!\ddot{U}}$，都是已知的。为了求在时刻$t+\Delta t$的未知量$^{t+\Delta t}\!U,{^{t+\Delta t}\!\dot{U}},{^{t+\Delta t}\!\ddot{U}}$，该方法将一个时间步长$\Delta t$划分为两个子时间步长$\gamma\Delta t,(1-\gamma)\Delta t$。

在第一个时间子步$\gamma\Delta t$内，采用Trapezoidal规则\cite{book:dover}进行计算,即
\begin{align}
{^{t+\gamma\Delta t}\!\dot{U}}&={^{t}\!\dot{U}}+\frac{{^t\!\ddot{U}}+{^{t+\gamma\Delta t}\!\ddot{U}}}{2}\gamma\Delta t\label{eq:bathev}\\
{^{t+\gamma\Delta t}\!{U}}&={^{t}\!U}+\frac{{^t\!\dot{U}}+{^{t+\gamma\Delta t}\!\dot{U}}}{2}\gamma\Delta t\label{eq:bathed}
\end{align}

为了求得在$\gamma+\Delta t$时刻的加速度，需要引入在该时刻的离散形式的平衡方程
\begin{equation}
	M{^{t+\gamma\Delta t}\!\ddot{U}}+C{^{t+\gamma\Delta t}\!\dot{U}}+K{^{t+\gamma\Delta t}\!U}={^{t+\gamma\Delta t}\!F}\label{eq:batheDyEq}
\end{equation}
利用方程(\ref{eq:bathev})-(\ref{eq:batheDyEq})就可以求得在中间时刻$t+\gamma\Delta t$处的位移${^{t+\gamma\Delta t}\!U}$、速度${^{t+\gamma\Delta t}\!\dot{U}}$和加速度${^{t+\gamma\Delta t}\!\ddot{U}}$。然后对于第二子步内的更新则是利用了三点向后微分公式\cite{Bathe2005}
\begin{equation}	
	{^{t+\Delta t}\!\dot{f}}=c_1{^t\!f}+c_2{^{t+\gamma\Delta t}\!f}+c_3{^{t+\Delta t}\!f}
\end{equation}

其中，系数$c_1,c_2$和$c_3$分别为
\begin{align}
	c_1&=\frac{1-\gamma}{\Delta t\gamma}\\
	c_2&=\frac{-1}{(1-\gamma)\gamma\Delta t}\\
	c_3&=\frac{2-\gamma}{(1-\gamma)\Delta t}
\end{align}
于是，当$f$分别表示位移和速度时，则有：
\begin{align}
	{^{t+\Delta t}\!\dot{U}}&=c_1{^t\!U}+c_2{^{t+\gamma\Delta t}\!U}+c_3{^{t+\Delta t}\!U}\label{eq:batheV2}\\
	{^{t+\Delta t}\!\ddot{U}}&=c_1{^t\!\dot{U}}+c_2{^{t+\gamma\Delta t}\!\dot{U}}+c_3{^{t+\Delta t}\!\dot{U}}\label{eq:batheA2}
\end{align}
同时，利用$t+\Delta t$时刻的平衡方程
\begin{equation}
	M{^{t+\Delta t}\!\ddot{U}}+C{^{t+\Delta t}\!\dot{U}}+K{^{t+\Delta t}\!U}={^{t+\Delta t}\!F}
\end{equation}
通过利用方程(\ref{eq:batheV2})-(\ref{eq:batheDyEq1})就可以求出在时刻$t+\Delta t$的位移${^{t+\Delta t}\!U}$、速度${^{t+\Delta t}\!\dot{U}}$和加速度${^{t+\Delta t}\!\ddot{U}}$。这样就完成了状态量从$t$时刻到$t+\Delta t$的转换，进而可以求解到满意的时间内的位移、速度和加速度值。

K.J. Bathe教授在文\inlinecite{Bathe2005,Bathe2007,Bathe2012a}并没有给出在第二个子步内求解非线性问题时，迭代的位移初值选择规则。而文\inlinecite{Silva2008}中给出了下列的预测值计算格式
\begin{equation}
{^{t+\Delta t}\!U}={^{t+\gamma\Delta t}\!U}+(1-\gamma)\Delta t{^{t+\gamma\Delta t}\!\dot{U}}+\frac{(1-\gamma)^2\Delta t^2}{4}{^{t+\gamma\Delta t}\!\ddot{U}}
\end{equation}

需要说明的是，章杰等人\cite{Zhang2017}已经证明了，若在第一子步内使用Newmark算法\cite{book:dover}，则K.J.Bethe所提出的复合型子步算法在众多算法中具有最优性。同时，K.J. Bathe在文章\inlinecite{Bathe2005}中使用了$\gamma=0.5$来求解非线性问题较Trapezoidal规则取得了一定的优势。另外一个值得推荐的$\gamma$取值是$2-\sqrt{2}$。$\gamma=2-\sqrt{2}$的使用具有以下几方面的意义：
\begin{itemize}
	\item 在求解非线性问题时，可以使得在两个子步内的有效刚度矩阵是一致的，进而降低计算量\cite{Dharmaraja2009,Bathe2007,Bathe2012a}。如求解线性问题，该值可以给出问题的最优数值响应值\cite{Bathe2007,Bathe2012a}。
	\item 该值给出了最小的截断误差常数\cite{Dharmaraja2009,Zhang2017}和最大的线性化稳定域\cite{Dharmaraja2009}。
	\item 在众多合适的$\gamma$中，该值能实现谱半径和周期误差曲线最低；同时，数值能量耗散最大\cite{Klarmann2015}。
\end{itemize}
有意思的是，$\gamma=0.731$被Klarmann等人所建议\cite{Klarmann2015}。该值能提升加速度响应的计算精度。


当然，上述的复合子步技巧也可以用于多个子步，亦即在一个时间步长$\Delta t$内，将其分为$n$份，每份不一定要求相等，而在每一个子步内使用不同的积分方法进行求解，进而复合成新的直接积分法。利用该技巧，许多学者又提出了新的复合型子步算法。
%=====================================================================================================================
\subsection{TR-TR-Houbolt算法}
K.J. Bathe等人将上述思想一般化，提出了一个三子步复合型算法\cite{Bathe2005}。将时间步长均分为三个相等的子步长$\Delta t/3$，在前两个子步长内均使用Trapezoidal规则，在第三个子步长内，利用已知的$t,t+\Delta t/3,t+2\Delta t/3$时刻的信息雇用Houbolt算法\cite{Chopra2011,book:dover}进行计算获得在$t+\Delta t$时刻的状态量。在三个子步内的更新公式分别如下
\begin{equation}
\text{第一个子步}\left\{
\begin{aligned}
{^{t+\Delta t/3}\!\dot{U}}&={^{t}\!\dot{U}}+\frac{1}{6}\Delta t({^t\!\ddot{U}}+{^{t+\Delta t/3}\!\ddot{U}})\\
{^{t+\Delta t/3}\!{U}}&={^{t}\!{U}}+\frac{1}{6}\Delta t({^t\!\dot{U}}+{^{t+\Delta t/3}\!\dot{U}})
\end{aligned}\right.
\end{equation}
\begin{equation}
\text{第二个子步}\left\{
\begin{aligned}
{^{t+2\Delta t/3}\!\dot{U}}&={^{t+\Delta t/3}\!\dot{U}}+\frac{1}{6}\Delta t({^{t+\Delta t/3}\!\ddot{U}}+{^{t+2\Delta t/3}\!\ddot{U}})\\
{^{t+2\Delta t/3}\!{U}}&={^{t+\Delta t/3}\!{U}}+\frac{1}{6}\Delta t({^{t+\Delta t/3}\!\dot{U}}+{^{t+2\Delta t/3}\!\dot{U}})
\end{aligned}\right.
\end{equation}
\begin{equation}
\text{第三个子步}\left\{
\begin{aligned}
\Delta t\cdot{^{t+\Delta t}\!\dot{U}}&=d_1{^t\!U}+d_2{^{t+\Delta t/3}\!U}+d_3{^{t+2\Delta t/3}\!U}+d_4{^{t+\Delta t}\!U}\\
\Delta t\cdot{^{t+\Delta t}\!\ddot{U}}&=d_1{^t\!\dot{U}}+d_2{^{t+\Delta t/3}\!\dot{U}}+d_3{^{t+2\Delta t/3}\!\dot{U}}+d_4{^{t+\Delta t}\!\dot{U}}
\end{aligned}\right.
\end{equation}%============
其系数取值为
\begin{equation}
d_1=-1\quad d_2=\frac{9}{2}\quad d_3=-9\quad d_4 = \frac{11}{2}
\end{equation}
\subsection{BDF2-Newmark算法}
利用复合子步的技巧，许多学者\cite{Kumara,Guwahati,Zhang2017}将时间步长$\Delta t$一份为二，在前一个子步内使用Newmark算法\cite{Newmark1959}，后一个使用三点向后微分公式(BDF2)\cite{Gear1971a}。同时假定在两个子步不一定均分。进而分析了子步的不均等划分以及Newmark参数对数值性能的影响。在第一个子步内使用Newmark算法有
\begin{align}
{^{t+p\Delta t}\!\dot{U}}&={^t\!\dot{U}}+p\Delta t[(1-\gamma){^t\!\ddot{U}}+\gamma{^{t+p\Delta t}\!\ddot{U}}]\\
{^{t+p\Delta t}\!U}&={^t\!U}+p\Delta t{^t\!\dot{U}}+(p\Delta t)^2\left[(\frac{1}{2}-\beta){^t\!\ddot{U}}+\beta{^{t+p\Delta t}\!\ddot{U}}\right]
\end{align}
在第二个子步内使用三点向后微分公式(\ref{eq:batheV2})-(\ref{eq:batheA2})。

文\inlinecite{Zhang2017}已经给出结论，当参数取值满足
\begin{equation}
p=2-\sqrt{2}\qquad\gamma=\frac{1}{2}\qquad\beta=\frac{1}{4}
\end{equation}
TR-Newmark算法给出了位移和加速度的最小误差主项。此时，TR-Newmark算法将退化为TR-BDF2算法。
\subsection{BDF型积分算法}
对K.J. Bathe提出的复合型子步算法进行扩展的策略是利用下列基于向后微分公式的广义四步线性多步法\cite{Dong2010}：
\begin{equation}
	\alpha_1{^{t+\Delta t}\!y}+\alpha_2{^{t}\!y}+(\frac{7}{2}-6\alpha_1-3\alpha_2){^{t-\Delta t}\!y}+(8\alpha_1+3\alpha_2-6){^{t-2\Delta t}\!y}+(\frac{5}{2}-3\alpha_1-\alpha_2){^{t-3\Delta t}\!y}={^{t+\Delta t}\!\dot{y}\Delta t}\label{eq:forthbackdiff}
\end{equation}
其零稳定性要求参数$\alpha_1$和$\alpha_2$需要满足下列条件
\begin{equation}
\alpha_2\le-2\alpha_1+\frac{3}{2}\qquad \alpha_2>-\frac{18}{5}\alpha_1+\frac{5}{2}
\end{equation}

当参数$\alpha_2$满足$\alpha_2=\frac{5}{2}-3\alpha_1$时，四步向后微分公式(\ref{eq:forthbackdiff})将退化为三步形式，即
\begin{equation}
	\alpha_1{^{t+\Delta t}\!y}+(\frac{5}{2}-3\alpha_1){^{t}\!y}+(3\alpha_1-4){^{t-\Delta t}\!y}+(\frac{3}{2}-\alpha_1){^{t-2\Delta t}\!y}={^{t+\Delta t}\!\dot{y}\Delta t}\label{eq:threebackdiff}
\end{equation}
此时的零稳定要求$\alpha_1\ge1$。需要注意到是
\begin{itemize}
\item 当$\alpha_1=\frac{3}{2}$，公式(\ref{eq:threebackdiff})退化为二阶的三点向后微分公式(BDF2)。
\item 当$\alpha_1=\frac{11}{6}$，公式(\ref{eq:threebackdiff})退化为三阶的四点向后微分公式(BDF3)。
\end{itemize}

Dong在文\inlinecite{Dong2010}中令$\alpha_1=\frac{11}{6}-\frac{\theta}{3}$，于是得到与公式(\ref{eq:threebackdiff})等价形式
\begin{equation}
A(\theta){^{t+\Delta t}\!y}+B(\theta){^{t}\!y}+C(\theta){^{t-\Delta t}\!y}+D(\theta){^{t-2\Delta t}\!y}={^{t+\Delta t}\!\dot{y}}\Delta t\label{eq:Dong12}
\end{equation}
其中
\begin{alignat}{2}
A(\theta)&=\frac{11}{6}-\frac{\theta}{3}&\qquad B(\theta)&=\theta-3\label{eq:DongA}\\
C(\theta)&=\frac{3}{2}-\theta&\qquad D(\theta)&=-\frac{1}{3}+\frac{\theta}{3}\label{eq:DongD}
\end{alignat}
此时的零稳定性对参数$\theta$要求$\theta\le\frac{5}{2}$。

基于公式(\ref{eq:Dong12})，第一个积分算法可构造如下：
\begin{align}
{^{t+\Delta t}\!\dot{U}}&=\frac{A(\theta_1)}{\Delta t}{^{t+\Delta t}\!U}+\frac{B(\theta_1)}{\Delta t}{^{t}\!U}+\frac{C(\theta_1)}{\Delta t}{^{t-\Delta t}\!U}+\frac{D(\theta_1)}{\Delta t}{^{t-2\Delta t}\!U}\\
{^{t+\Delta t}\!\ddot{U}}&=\frac{A(\theta_2)}{\Delta t}{^{t+\Delta t}\!\dot{U}}+\frac{B(\theta_2)}{\Delta t}{^{t}\!\dot{U}}+\frac{C(\theta_2)}{\Delta t}{^{t-\Delta t}\!\dot{U}}+\frac{D(\theta_2)}{\Delta t}{^{t-2\Delta t}\!\dot{U}}
\end{align}
有意思的是，算法参数$\theta_1$和$\theta_2$可以取不同的值。当然根据前面的陈述，它们都应该满足零稳定性要求，即$\theta_1,\theta_2\le\frac{5}{2}$。Dong通过考虑一个单自由度振子分析了该算法获得无条件稳定性时的参数$\theta_1,\theta_2$的取值范围。


考虑更加一般性的四点向后微分公式(\ref{eq:forthbackdiff})，令下列的参数变换
\begin{equation}
\alpha_1=-\frac{1}{3}\theta_1\theta_2-\frac{1}{4}\theta_2+\frac{25}{12}\qquad \alpha_2=\theta_1\theta_2+\theta_2-4
\end{equation}
则，等式(\ref{eq:forthbackdiff})可化为
\begin{align}
A_1(\theta_1,\theta_2){^{t+\Delta t}\!y}+A_2(\theta_1,\theta_2){^{t}\!y}+&A_3(\theta_1,\theta_2){^{t-\Delta t}\!y}\notag\\
&+A_4(\theta_1,\theta_2){^{t-2\Delta t}\!y}+A_5(\theta_1,\theta_2){^{t-3\Delta t}\!y}={^{t+\Delta t}\!\dot{y}\Delta t}\label{eq:Dong20}
\end{align}
其中，
\begin{equation}
\left\{\begin{aligned}
A_1(\theta_1,\theta_2)&=-\frac{1}{3}\theta_1\theta_2-\frac{1}{4}\theta_2+\frac{25}{12}\\
A_2(\theta_1,\theta_2)&=\theta_1\theta_2+\theta_2-4\\
A_3(\theta_1,\theta_2)&=-\theta_1\theta_2-\frac{3}{2}\theta_2+3\\
A_4(\theta_1,\theta_2)&=\frac{1}{3}\theta_1\theta_2+\theta_2-\frac{4}{3}\\
A_5(\theta_1,\theta_2)&=\frac{1}{4}-\frac{1}{4}\theta_2 
\end{aligned}\right.
\end{equation}
同理，其零稳定性要求
\begin{equation}
\begin{cases}
(\theta_1+\frac{3}{2})\theta_2\le4\\
(\theta_1-\frac{1}{2})\theta_2<5
\end{cases}
\end{equation}
于是，基于等式(\ref{eq:Dong20})可得第二个积分算法如下：
\begin{align}
{^{t+\Delta t}\!\dot{U}}=\frac{A_1(\theta_1,\theta_2)}{\Delta t}{^{t+\Delta t}\!U}+\frac{A_2(\theta_1,\theta_2)}{\Delta t}{^{t}\!U}+&\frac{A_3(\theta_1,\theta_2)}{\Delta t}{^{t-\Delta t}\!U}\notag\\
&+\frac{A_4(\theta_1,\theta_2)}{\Delta t}{^{t-2\Delta t}\!U}+\frac{A_5(\theta_1,\theta_2)}{\Delta t}{^{t-3\Delta t}\!U}\\
{^{t+\Delta t}\!\ddot{U}}=\frac{A_1(\theta_1,\theta_2)}{\Delta t}{^{t+\Delta t}\!\dot{U}}+\frac{A_2(\theta_1,\theta_2)}{\Delta t}{^{t}\!\dot{U}}+&\frac{A_3(\theta_1,\theta_2)}{\Delta t}{^{t-\Delta t}\!\dot{U}}\notag\\
&+\frac{A_4(\theta_1,\theta_2)}{\Delta t}{^{t-2\Delta t}\!\dot{U}}+\frac{A_5(\theta_1,\theta_2)}{\Delta t}{^{t-3\Delta t}\!\dot{U}}
\end{align}
可以通过计算一个单自由度振子来获得该算法的无条件稳定域。Dong在文\inlinecite{Dong2010}指出当参数$(\theta_1,\theta_2)=(1/2,4/5)$是无条件稳定的，且具有最小的耗散特性。

最后，Dong通过利用K.J. Bathe的复合子步技巧，利用前面发展的三步、四步向后微分公式结合Trapezoidal规则提出了新的复合型子步算法\cite{Dong2010}。即将一个时间步长分为两个相等的子步长，在前一个子步长内利用Trapezoidal规则，即公式(\ref{eq:bathev})-(\ref{eq:batheDyEq})带有$\gamma=1/2$，在第二个子步雇用前面发展的向后微分公式进行计算，即
\begin{align}
{^{t+\Delta t}\!\dot{U}}=\frac{A_1(\theta_1,\theta_2)}{\Delta t/2}{^{t+\Delta t}\!U}+\frac{A_2(\theta_1,\theta_2)}{\Delta t/2}&{^{t+\frac{1}{2}\Delta t}\!U}+\frac{A_3(\theta_1,\theta_2)}{\Delta t/2}{^{t}\!U}\notag\\
&+\frac{A_4(\theta_1,\theta_2)}{\Delta t/2}{^{t-\frac{1}{2}\Delta t}\!U}+\frac{A_5(\theta_1,\theta_2)}{\Delta t/2}{^{t-\Delta t}\!U}\\
{^{t+\Delta t}\!\ddot{U}}=\frac{A_1(\theta_1,\theta_2)}{\Delta t/2}{^{t+\Delta t}\!\dot{U}}+\frac{A_2(\theta_1,\theta_2)}{\Delta t/2}&{^{t+\frac{1}{2}\Delta t}\!\dot{U}}+\frac{A_3(\theta_1,\theta_2)}{\Delta t/2}{^{t}\!\dot{U}}\notag\\
&+\frac{A_4(\theta_1,\theta_2)}{\Delta t/2}{^{t-\frac{1}{2}\Delta t}\!\dot{U}}+\frac{A_5(\theta_1,\theta_2)}{\Delta t/2}{^{t-\Delta t}\!\dot{U}}
\end{align}
通过零稳定性分析，可以得到其参数的约束条件为
\begin{equation}
(\theta_1+\frac{3}{2})\theta_2<\frac{19}{4},\qquad\theta_2\ge-2
\end{equation}
或者
\begin{equation}
(\theta_1+\frac{3}{2})\theta_2>\frac{19}{4},\qquad\theta_2\le-2
\end{equation}

若在第一个时间子步内，使用Newmark-$(\beta,\gamma=1/2)$算法\cite{book:dover}进行计算，即
\begin{align}
\theta_2({^{t+\frac{1}{2}\Delta t}\!U}-{^t\!U})&=\theta_2\left(\frac{\Delta t}{2}\right){^{t}\!\dot{U}}+\left(\frac{\Delta t}{2}\right)^2{^{t+\frac{1}{2}\Delta t}\!\ddot{U}}+\left(\frac{\theta_2}{2}-1\right)\left(\frac{\Delta t}{2}\right)^2{^{t}\!\ddot{U}}\\
{^{t+\frac{1}{2}\Delta t}\!\dot{U}}-{^t\!\dot{U}}&=\frac{\Delta t}{4}({^{t+\frac{1}{2}\Delta t}\!\ddot{U}}-{^{t}\!\ddot{U}})
\end{align}
参数$\theta_2$实质上是扮演着$1/\beta$的角色。当$\theta_2=4$将退化为Trapezoidal规则。为了实现在第一个子步内地无条件稳定性，参数$\theta_2$应当满足\cite{book:dover}
\begin{equation}
0<\theta_2\le4
\end{equation}

在第二个子步内，Dong使用了如下的格式计算$t+\Delta t$时刻的位移和速度，即
\begin{align}
(3-\frac{3}{2}\theta_1){^{t+\Delta t}\!U}-6(1-\theta_1)&{^{t+\frac{1}{2}\Delta t}\!U}+\left(3-\frac{9}{2}\theta_1\right){^t\!U}\notag\\
&=2\frac{\Delta t}{2}{^{t+\frac{1}{2}\Delta t}\!\dot{U}}+(3\theta_1-2)\frac{\Delta t}{2}{^t\!\dot{U}}+\left(\frac{\Delta t}{2}\right)^2{^{t+\Delta t}\!\ddot{U}}\\
\frac{\Delta t}{2}{^{t+\Delta t}\!\dot{U}}&=\frac{3}{2}{^{t+\Delta t}\!U}-2{^{t+\frac{1}{2}\Delta t}\!U}+\frac{1}{2}{^t\!U}
\end{align}
通过Taylor级数展开可以证明该格式对于任意的$\theta_1$取值都是二阶精度的\cite{Dong2010}。当参数$\theta_1=1/2$时，上式退化为二阶的向后微分公式(BDF2)。于是，当参数$(\theta_1,\theta_2)=(1/2,4)$时，对于该复合型子步算法退化为前述提及的K.J. Bathe复合型子步算法\cite{Bathe2005,Bathe2007,Bathe2012a}。


\subsection{TTBDF算法}
Chandra和Zhou等人基于Dong提出的BDF型算法\cite{Dong2010}提出了一个三子步方法\cite{Chandra2015}。亦即将时间步长$\Delta t$分为三等份。在第一个子步内使用Trapezoidal规则，即
\begin{align}
{^{t+\frac{1}{3}\Delta t}\!U}&={^t\!U}+\frac{\Delta t}{6}({^{t}\!\dot{U}}+{^{t+\frac13\Delta t}\!\dot{U}})\\
{^{t+\frac{1}{3}\Delta t}\!\dot{U}}&={^t\!\dot{U}}+\frac{\Delta t}{6}({^{t}\!\ddot{U}}+{^{t+\frac13\Delta t}\!\ddot{U}})
\end{align}
且在$t+\frac{1}{3}\Delta t$时刻处满足平衡方程(\ref{eq:DyEq})。

在第二个子步内仍然雇用Trapezoidal规则进行计算，则有
\begin{align}
{^{t+\frac{2}{3}\Delta t}\!U}&={^{t+\frac{1}{3}\Delta t}\!U}+\frac{\Delta t}{6}({^{t+\frac13\Delta t}\!\dot{U}}+{^{t+\frac23\Delta t}\!\dot{U}})\\
{^{t+\frac{2}{3}\Delta t}\!\dot{U}}&={^{t+\frac{1}{3}\Delta t}\!\dot{U}}+\frac{\Delta t}{6}({^{t+\frac13\Delta t}\!\ddot{U}}+{^{t+\frac23\Delta t}\!\ddot{U}})
\end{align}
且在$t+\frac{2}{3}\Delta t$时刻处满足平衡方程(\ref{eq:DyEq})。

在最后一个子步，也就是第三个子步内利用Dong提出的四点向后微分公式(\ref{eq:Dong12})，
\begin{align}
{^{t+\Delta t}\!\dot{U}}&=\frac{A(\theta_1)}{\Delta t/3}{^{t+\Delta t}\!{U}}+\frac{B(\theta_1)}{\Delta t/3}{^{t+\frac23\Delta t}\!{U}}+\frac{C(\theta_1)}{\Delta t/3}{^{t+\frac13\Delta t}\!{U}}+\frac{D(\theta_1)}{\Delta t/3}{^{t}\!{U}}\\
{^{t+\Delta t}\!\ddot{U}}&=\frac{A(\theta_2)}{\Delta t/3}{^{t+\Delta t}\!\dot{U}}+\frac{B(\theta_2)}{\Delta t/3}{^{t+\frac23\Delta t}\!\dot{U}}+\frac{C(\theta_2)}{\Delta t/3}{^{t+\frac13\Delta t}\!\dot{U}}+\frac{D(\theta_2)}{\Delta t/3}{^{t}\!\dot{U}}
\end{align}
其中，$A,B,C,D$取值来自于等式(\ref{eq:DongA})-(\ref{eq:DongD})。当参数$(\theta_1,\theta_2)=(0.75,0.75)$时，在众多的无条件稳定算法中，具有最小的耗散特性\cite{Chandra2015}。

\subsection{BDF2-BDF3算法}
根据文\inlinecite{Gear1971a}，可以知道二阶的向后微分公式(BDF2)可以表达为
\begin{equation}
{^{t+\Delta t}\!\dot{U}}=\frac{3}{2\Delta t}{^{t+\Delta t}\!U}-\frac{2}{\Delta t}{^{t}\!U}+\frac{1}{2\Delta t}{^{t-\Delta t}\!U}
\end{equation}
而三阶向后微分公式(BDF3)则为
\begin{equation}
{^{t+\Delta t}\!\dot{U}}=\frac{11}{6\Delta t}{^{t+\Delta t}\!U}-\frac{3}{\Delta t}{^{t}\!U}+\frac{3}{2\Delta t}{^{t-\Delta t}\!U}-\frac{1}{3\Delta t}{^{t-2\Delta t}\!U}
\end{equation}

于是，Dong将BDF2和BDF3公式组合，可以得到如下的组合模式\cite{Dong2013}
\begin{align}
{^{t+\Delta t}\!\dot{U}}&=(1-\theta_1)\left(\frac{11}{6\Delta t}{^{t+\Delta t}\!U}-\frac{3}{\Delta t}{^{t}\!U}+\frac{3}{2\Delta t}{^{t-\Delta t}\!U}-\frac{1}{3\Delta t}{^{t-2\Delta t}\!U} \right)\notag\\
&+\theta_1\left(\frac{3}{2\Delta t}{^{t+\Delta t}\!U}-\frac{2}{\Delta t}{^{t}\!U}+\frac{1}{2\Delta t}{^{t-\Delta t}\!U} \right)\\
{^{t+\Delta t}\!\ddot{U}}&=(1-\theta_2)\left(\frac{11}{6\Delta t}{^{t+\Delta t}\!\dot{U}}-\frac{3}{\Delta t}{^{t}\!\dot{U}}+\frac{3}{2\Delta t}{^{t-\Delta t}\!\dot{U}}-\frac{1}{3\Delta t}{^{t-2\Delta t}\!\dot{U}} \right)\notag\\
&+\theta_2\left(\frac{3}{2\Delta t}{^{t+\Delta t}\!\dot{U}}-\frac{2}{\Delta t}{^{t}\!\dot{U}}+\frac{1}{2\Delta t}{^{t-\Delta t}\!\dot{U}}\right)
\end{align}
当参数$(\theta_1,\theta_2)$取不同的值时，上述组合算法BDF2-BDF3将退化为不同的积分公式，如
\begin{itemize}
\item 当$(\theta_1,\theta_2)=(0,0)$时，BDF2-BDF3退化为BDF3。
\item 当$(\theta_1,\theta_2)=(1,1)$时，BDF2-BDF3退化为BDF2。
\item 当$(\theta_1,\theta_2)=(1/2,1/2)$时，BDF2-BDF3退化为著名的Park积分算法\cite{Park1975}。
\end{itemize}
当参数$(\theta_1,\theta_2)$在集合$I=\{(\theta_1,\theta_2)|\theta_1+\theta_2\ge1,0\le\theta_1,\theta_2\le1\}$时，BDF2-BDF3实现无条件稳定\cite{Dong2013}。

\subsection{BDF3BDF2-Newmark算法}
Dong利用前述提及的的BDF2-BDF3组合算法和Trapezoidal规则进行组合，进而提出了一个新的复合型子步算法,BDF3BDF2-Newmark算法\cite{Dong2013}。该算法将时间步长$\Delta t$分为两个相等的子步长$\Delta t/2$，在第一个子步长内使用Trapezoidal规则，即
\begin{align}
{^{t+\frac{1}{2}\Delta t}\!U}&={^t\!U}+\frac{\Delta t}{4}({^{t}\!\dot{U}}+{^{t+\frac12\Delta t}\!\dot{U}})\\
{^{t+\frac{1}{2}\Delta t}\!\dot{U}}&={^t\!\dot{U}}+\frac{\Delta t}{4}({^{t}\!\ddot{U}}+{^{t+\frac12\Delta t}\!\ddot{U}})
\end{align}
对于第二个子步长，则使用BDF2-BDF3组合算法，即
\begin{align}
{^{t+\Delta t}\!\dot{U}}&=\frac{A(\theta_1)}{\Delta t/3}{^{t+\Delta t}\!{U}}+\frac{B(\theta_1)}{\Delta t/3}{^{t+\frac12\Delta t}\!{U}}+\frac{C(\theta_1)}{\Delta t/3}{^{t}\!{U}}+\frac{D(\theta_1)}{\Delta t/3}{^{t-\frac12\Delta t}\!{U}}\\
{^{t+\Delta t}\!\ddot{U}}&=\frac{A(\theta_2)}{\Delta t/3}{^{t+\Delta t}\!\dot{U}}+\frac{B(\theta_2)}{\Delta t/3}{^{t+\frac12\Delta t}\!\dot{U}}+\frac{C(\theta_2)}{\Delta t/3}{^{t}\!\dot{U}}+\frac{D(\theta_2)}{\Delta t/3}{^{t-\frac12\Delta t}\!\dot{U}}
\end{align}
其中，
\begin{equation}
\left\{\begin{aligned}
A(\theta)&=\frac{11}{6}(1-\theta)+\frac32\theta\\
B(\theta)&=3(\theta-1)-2\theta\\
C(\theta)&=\frac{3}{2}(1-\theta)+\frac{1}{2}\theta\\
D(\theta)&=\frac{1}{3}(\theta-1)
\end{aligned}\right.
\end{equation}

显然，该算法不是自启动的。在第一个时间步长内，需要额外的启动机制，如连续使用两次Trapezoidal规则。当参数$(\theta_1,\theta_2)=(1,1)$时，BDF3BDF2-Newmark算法将退化为K.J. Bathe提出的TR-BDF2算法。

\subsection{CTFEA算法}
Kim和Reddy利用时间有限元配点方法导出了一个复合型子步算法(CTFEA)\cite{Kim2016}，在第一个子步$(t_s,t_s+\gamma\Delta t)$内，使用线性插值形函数如下
\begin{equation}
\psi_s^L=\frac{\gamma\Delta t-t+t_s}{\gamma\Delta t}\qquad \psi_{s+\gamma\Delta t}^L=\frac{t-t_s}{\gamma\Delta t}
\end{equation}
其上标$L$表示使用了线性插值函数。于是使用上述形函数，在第一个子步内的状态变量值可以近似表达为
\begin{equation}
\begin{cases}
U(t)\approx{^t\!U}=\psi_s^L(t){^s\!U}+\psi_{s+\gamma\Delta t}^L(t){^{s+\gamma\Delta t}\!U}\\
\dot{U}(t)\approx{^t\!\dot{U}}=\psi_s^L(t){^s\!\dot{U}}+\psi_{s+\gamma\Delta t}^L(t){^{s+\gamma\Delta t}\!\dot{U}}\\
\ddot{U}(t)\approx{^t\!\ddot{U}}=\psi_s^L(t){^s\!\ddot{U}}+\psi_{s+\gamma\Delta t}^L(t){^{s+\gamma\Delta t}\!\ddot{U}}
\end{cases}
\end{equation}
上述关系式只是近似成立，亦即其残差一般情况下不为0。故其速度和加速度的残差可以表达为
\begin{equation}
\begin{cases}
r_1(t)&=\dot{U}(t)-{^t\!\dot{U}}\\
r_2(t)&=\ddot{U}(t)-{^t\!\ddot{U}}
\end{cases}
\end{equation}
在区间$t_s\le t\le t_{s+\gamma\Delta t}$通过利用配点法可以得到如下表达式
\begin{equation}
\begin{cases}
0&=\int_{t_s}^{t_{s+\gamma\Delta t}}\delta(t-\theta_1\gamma\Delta t)r_1(t)dt\\
0&=\int_{t_s}^{t_{s+\gamma\Delta t}}\delta(t-\theta_1\gamma\Delta t)r_2(t)dt
\end{cases}
\end{equation}
其中，$\theta_1$表示在第一个子步内的配点参数。文\inlinecite{Kim2016}建议其$\theta_1$取值应满足$0.5\le\theta_1\le1$来获得无条件稳定性。

于是，经过计算可以得到其速度和加速度的更新方程
\begin{align}
{^{t+\gamma\Delta t}\!\dot{U}}&=c_1{^{t+\gamma\Delta t}\!U}+c_2{^t\!U}+c_3{^{t}\!\dot{U}}\\
{^{t+\gamma\Delta t}\!\ddot{U}}&=c_1{^{t+\gamma\Delta t}\!\dot{U}}+c_2{^t\!\dot{U}}+c_3{^{t}\!\ddot{U}}
\end{align}
其中，参数$c_1,c_2$和$c_3$取值为
\begin{equation}
c_1=\frac{1}{\gamma\theta_1\Delta t}\quad c_2=-\frac{1}{\gamma\theta_1\Delta t}\quad c_3=\frac{\theta_1-1}{\theta_1}
\end{equation}
需要说明的是，在第一个子步内的计算实质上等价于广义的Trapezoidal规则\cite{book:dover}。
\begin{itemize}
\item 当$\theta_1=0.5$时，上述算法将退化为Trapezoidal规则。
\item 当$\theta_1=1.0$时，上述算法将退化为向后Euler公式。
\end{itemize}

类似地，在第二个子步长内，Kim等人利用了二次插值函数进行逼近计算，然后将残差再利用配点进行计算，进而得到如下的计算格式：
\begin{align}
{^{t+\Delta t}\!\dot{U}}&=d_1{^{t+\Delta t}\!U}+d_2{^{t+\gamma\Delta t}\!U}+d_3{^{t}\!U}+d_4{^{t+\gamma\Delta t}\!\dot{U}}+d_5{^{t}\!\dot{U}}\\
{^{t+\Delta t}\!\ddot{U}}&=d_1{^{t+\Delta t}\!\dot{U}}+d_2{^{t+\gamma\Delta t}\!\dot{U}}+d_3{^{t}\!\dot{U}}+d_4{^{t+\gamma\Delta t}\!\ddot{U}}+d_5{^{t}\!\ddot{U}}
\end{align}
其中，系数取值分别为
\begin{equation}
\left\{\begin{aligned}
d_1&=\frac{\gamma-2\theta_2}{\theta_2(\gamma-\theta_2)\Delta t}\qquad d_2=\frac{2\theta_2-1}{\gamma\theta_2(\gamma-\theta_2)\Delta t}\\
d_3&=\frac{(\gamma-1)(\gamma+1-2\theta_2)}{\gamma\theta_2(\gamma-\theta_2)\Delta t}\\
d_4&=\frac{\theta_2-1}{\gamma(\theta_2-\gamma)}\qquad d_5=\frac{(\theta_2-1)(\gamma-1)}{\gamma\theta_2}
\end{aligned}\right.
\end{equation}

当CTFEMA算法中的参数$(\theta_1,\theta_2)=(0.5,1.0)$时，该算法将退化为TR-BDF2算法\cite{Bathe2005,Bathe2007,Bathe2012a}。特别地，$\theta_1=0.5$时，CTFEMA算法可实现二阶精度。同时对于参数$\gamma$的取值，需要注意的是
\begin{itemize}
\item $\gamma$应满足$0.5\le\gamma\le1.0$，此时线性系统的稳定性不受其影响，但对于非线性系统，其取值应尽量避免接近1.0。
\item $\gamma$合适的选择能提高数值阻尼的同时也能增加周期误差。
\item 当求解线性系统时，$\gamma$的选择能减小计算量。如，$\gamma$的合适选择可以使得两个子步内的等效刚度矩阵一致。
\end{itemize}
\subsection{TR-BDF2-Houbolt算法}
北京大学的魏文彬等人提出了一个三子步复合型算法\cite{Wen2017c}。亦即将一个时间步长分为三个子步长$p\Delta t,(1-2p)\Delta t,p\Delta t$，其中$0<p<0.5$。在第一个时间子步长内，Trapezoidal规则被雇用，即
\begin{align}
{^{t+p\Delta t}\!\dot{U}}&={^{t}\!\dot{U}}+\frac{1}{2}p\Delta t({^t\!\ddot{U}}+{^{t+p\Delta t}\!\ddot{U}})\\
{^{t+p\Delta t}\!{U}}&={^{t}\!{U}}+\frac{1}{2}p\Delta t({^t\!\dot{U}}+{^{t+p\Delta t}\!\dot{U}})
\end{align}
结合在$t+p\Delta t$时刻的平衡方程
\begin{equation}
M{^{t+p\Delta t}\!\ddot{U}}+C{^{t+p\Delta t}\!\dot{U}}+K{^{t+p\Delta t}\!U}={^{t+p\Delta t}\!F}
\end{equation}

在第二个子步内，使用了三点向后微分公式
\begin{align}
\Delta t\cdot{^{t+(1-p)\Delta t}\!\dot{U}}&=c_1{^t\!U}+c_2{^{t+p\Delta t}\!U}+c_3{^{t+(1-p)\Delta t}\!U}\\
\Delta t\cdot{^{t+(1-p)\Delta t}\!\ddot{U}}&=c_1{^t\!\dot{U}}+c_2{^{t+p\Delta t}\!\dot{U}}+c_3{^{t+(1-p)\Delta t}\!\dot{U}}
\end{align}
其中，系数取值为
\begin{equation}
c_1=\frac{2p-1}{p(p-1)}\quad c_2=\frac{1-p}{p(2p-1)}\quad c_3 = \frac{2-3p}{(p-1)(2p-1)}
\end{equation}
仍然使用在$t+(1-p)\Delta t$时刻的平衡方程
\begin{equation}
M{^{t+(1-p)\Delta t}\!\ddot{U}}+C{^{t+(1-p)\Delta t}\!\dot{U}}+K{^{t+(1-p)\Delta t}\!U}={^{t+(1-p)\Delta t}\!F}
\end{equation}

最后，在第三个子步内使用Houbolt方法\cite{Chopra2011,book:dover}进行计算$t+\Delta t$时刻的响应值。
\begin{align}
\Delta t\cdot{^{t+\Delta t}\!\dot{U}}&=d_1{^t\!U}+d_2{^{t+p\Delta t}\!U}+d_3{^{t+(1-p)\Delta t}\!U}+d_4{^{t+\Delta t}\!U}\\
\Delta t\cdot{^{t+\Delta t}\!\ddot{U}}&=d_1{^t\!\dot{U}}+d_2{^{t+p\Delta t}\!\dot{U}}+d_3{^{t+(1-p)\Delta t}\!\dot{U}}+d_4{^{t+\Delta t}\!\dot{U}}
\end{align}
系数$d_i,i=1,2,3,4$的取值如下
\begin{equation}
d_1=-1\quad d_2=\frac{1}{(p-1)(2p-1)}\quad d_3=\frac{1}{p(2p-1)}\quad d_4 = \frac{p^2-p-1}{p(p-1)}
\end{equation}
再结合$t+\Delta t$时刻的平衡方程(\ref{eq:batheDyEq1})。

文\inlinecite{Wen2017c}中数值试验表明，就精度和数值耗散特性而言，参数$p=1/3$是众多可取$p$值中最佳选择方案。

\subsection{TR-NBDDF-N算法}
文\inlinecite{Rezaiee-Pajand2010}将三点向后微分公式看作牛顿向后插值\cite{Gear1971a}的特例，则可以得到其更加一般化的复合型子步算法。当时间步长均分为两份时，该算法退化为TR-BDF2算法。对于均分为$m$份的复合型子步算法，可参见原文\cite{Rezaiee-Pajand2010}。这里仅显式地给出均分为3份的三子步复合型算法。
在第一个子步内，使用Trapezoidal规则，则有
\begin{align}
{^{t+\Delta t/3}\!\dot{U}}&=\frac{6}{\Delta t}({^{t+\Delta t/3}\!U}-{^{t}\!U})-{^t\!\dot{U}}\\
{^{t+\Delta t/3}\!\ddot{U}}&=\frac{6}{\Delta t}({^{t+\Delta t/3}\!\dot{U}}-{^{t}\!\dot{U}})-{^t\!\ddot{U}}
\end{align}

在第二个子步内，使用
\begin{align}
{^{t+2\Delta t/3}\!\dot{U}}&=\frac{3}{2\Delta t}{^t\!U}-\frac{6}{\Delta t}{^{t+\Delta t/3}\!U}+\frac{9}{2\Delta t}{^{t+2\Delta t/3}\!U}\\
{^{t+2\Delta t/3}\!\ddot{U}}&=\frac{27}{4\Delta t^2}{^t\!U}-\frac{27}{\Delta t^2}{^{t+\Delta t/3}\!U}+\frac{81}{4\Delta t^2}{^{t+2\Delta t/3}\!U}+\frac{9}{2\Delta t}{^t\!\dot{U}}-\frac{6}{\Delta t}{^{t+\Delta t/3}\!\dot{U}}
\end{align}

而在第三个子步内，计算格式则为
\begin{align}
{^{t+\Delta t}\!\dot{U}}&=-\frac{1}{\Delta t}{^t\!U}+\frac{9}{2\Delta t}{^{t+\Delta t/3}\!U}-\frac{9}{\Delta t}{^{t+2\Delta t/3}\!U}+\frac{11}{2\Delta t}{^{t+\Delta t}\!U}\\
{^{t+\Delta t}\!\ddot{U}}&=-\frac{11}{2\Delta t^2}{^t\!U}+\frac{11}{4\Delta t^2}{^{t+\Delta t/3}\!U}-\frac{99}{2\Delta t^2}{^{t+2\Delta t/3}\!U}+\frac{121}{4\Delta t^2}{^{t+\Delta t}\!U}\notag\\
&\qquad -\frac{1}{\Delta t}{^t\!\dot{U}}+\frac{9}{2\Delta t}{^{t+\Delta t/3}\!\dot{U}}-\frac{9}{\Delta t}{^{t+2\Delta t/3}\!\dot{U}}
\end{align}

三个子步结合三个时刻的平衡方程即可求解在$t+\Delta t$时刻的状态量。

\subsection{TR-RP算法}
Rezaiee-Pajand提出了一个两子步复合型算法\cite{Rezaiee-Pajand2015}。在第一个时间步长内，使用Trapezoidal规则进行计算。而在第二个子步内，引入更具一般性的算法格式
\begin{align}
{^{t+\Delta t}\!U}&={^t\!U}+\Delta t[A{^t\!\dot{U}}+B{^{t+\Delta t}\!\dot{U}}]+\Delta t^2[C{^{t}\!\ddot{U}}+D{^{t+\Delta t/2}\!\ddot{U}}]\label{eq:PR3}\\
{^{t+\Delta t}\!\dot{U}}&={^t\!\dot{U}}+\Delta t[E{^t\ddot{U}}+F{^{t+\Delta t/2}\!\ddot{U}}+G{^{t+\Delta t}\!\ddot{U}}]\label{eq:PR4}
\end{align}
若满足二阶精度，则要求下列等式成立
\begin{equation}
\left\{\begin{aligned}
A+B&=1\qquad B+C+D&=\frac{1}{2}\\
E+F+G&=1\qquad\quad \frac{1}{2}F+G&=\frac12
\end{aligned}\right.
\end{equation}
于是，上述等式(\ref{eq:PR3})-(\ref{eq:PR4})整理为两参数算法
\begin{align}
{^{t+\Delta t}\!U}&={^t\!U}+\Delta t[\alpha{^t\!\dot{U}}+(1-\alpha){^{t+\Delta t}\!\dot{U}}]+\Delta t^2[\beta{^{t}\!\ddot{U}}+(\alpha-\beta-\frac{1}{2}){^{t+\Delta t/2}\!\ddot{U}}]\\
{^{t+\Delta t}\!\dot{U}}&={^t\!\dot{U}}+\Delta t[(1-\alpha){^t\ddot{U}}+(2\alpha-1){^{t+\Delta t/2}\!\ddot{U}}+(1-\alpha){^{t+\Delta t}\!\ddot{U}}]
\end{align}
其中，参数$\alpha,\beta$的选取依据为
\begin{equation}
\alpha=2(\beta-0.125)+0.75\qquad 0<\beta<0.125\qquad 0.5<\alpha<0.75
\end{equation}
以满足算法实现
\begin{itemize}
\item[\ddag] 对线性系统无条件稳定。
\item[\ddag] 复合型算法实现二阶精度的同时，实现最小化低频、最大化高频耗散。
\item[\ddag] 新算法较Trapezoidal规则\cite{book:dover}和TR-BDF2算法\cite{Bathe2005,Bathe2007,Bathe2012a}精度更高。
\item[\ddag] 对Trapezoidal算法求解失败的非线性问题，新算法仍保持稳定性。
\end{itemize}









\section{复合型子步显式算法}
\subsection{Noh-Bathe两子步算法}
K.J. Bathe等人\cite{Noh2013}提出了一个两子步复合型显式算法来求解波的传播问题。在第一个子步长$p\Delta t$内，使用
\begin{align}
M{^{t+p\Delta t}\!\ddot{U}}+C{^{t+p\Delta t}\!\tilde{\dot{U}}}+K{^{t+p\Delta t}\!{U}}&={^{t+p\Delta t}\!F}\\
{^{t+p\Delta t}\!U}&={^t\!U}+(p\Delta t){^t\!\dot{U}}+\frac{1}{2}(p\Delta t)^2\cdot{^t\!\ddot{U}}\\
{^{t+p\Delta t}\!\tilde{\dot{U}}}&=(1-s)[{^t\!\dot{U}}+\frac{1}{2}(p\Delta t){^t\!\ddot{U}}]+s\cdot{^t\!\dot{U}}\\
{^{t+p\Delta t}\!\dot{U}}&={^t\!\dot{U}}+\frac{1}{2}(p\Delta t)({^t\!\ddot{U}}+{^{t+p\Delta t}\!\ddot{U}})
\end{align}

非常有意思的是，这里的带入平衡方程的速度更新公式并不是最后获得速度响应值的表达式。这二者分别由不同的速度更新公式计算。同时表达式${^{t+p\Delta t}\!F}$使用Trapezoidal规则\cite{Erlicher2002The}进行计算。

在第二个子步内，使用
\begin{align}
{^{t+\Delta t}\!F}&=M{^{t+\Delta t}\!\ddot{U}}+C{^{t+\Delta t}\!\tilde{\dot{U}}}+K{^{t+\Delta t}\!{U}}\\
{^{t+\Delta t}\!U}&={^{t+p\Delta t}\!U}+[(1-p)\Delta t]{^{t+p\Delta t}\!\dot{U}}+\frac{1}{2}[(1-p)\Delta t]^2\cdot{^{t+p\Delta t}\!\ddot{U}}\\
{^{t+\Delta t}\!\tilde{\dot{U}}}&=(1-s)[{^{t+p\Delta t}\!\dot{U}}+\frac{1}{2}[(1-p)\Delta t]{^{t+p\Delta t}\!\ddot{U}}]+s\cdot{^{t+p\Delta t}\!\dot{U}}\\
{^{t+\Delta t}\!\dot{U}}&={^{t+p\Delta t}\!\dot{U}}+\frac{1}{2}[(1-p)\Delta t]{^{t+p\Delta t}\!\ddot{U}}+[(1-p)\Delta t]\left(q_0{^t\!\ddot{U}}+q_1{^{t+p\Delta t}\!\ddot{U}}+q_2{^{t+\Delta t}\!\ddot{U}}\right)
\end{align}
为了在有无结构阻尼情况都实现二阶精度，上述参数应该满足
\begin{equation}
q_0+q_1+q_2=\frac{1}{2}\quad q_2=\frac{1}{2}-pq_1\quad s=-1
\end{equation}
使用Routh-Hurwitz稳定性准则\cite{book:dover}可以得到其最大的稳定性极限值
\begin{equation}
\Omega_s^2=\frac{1}{\gamma p(1-p)}
\end{equation}
其中
\begin{equation}
\gamma = \frac{1}{4}-\frac12(1-p)q_1\qquad -\frac{1}{4(1-p)}\le q_1\le\frac{4p(1-p)-1}{8p(1-p)^2}\label{eq:Noh17}
\end{equation}
特别地，当$p=0.5,q_1=0$时，其稳定性极限为$\Omega=4$，是中心差分法\cite{book:dover}的稳定性极限($\Omega_s=2$)的两倍。

为了使得分岔点处的频率值尽可能大，参数$q_1$需满足
\begin{equation}
q_1=\frac{1-2p}{2p(1-p)}
\end{equation}
此时的分岔点处的频率值$\Omega_b$\footnote{文\inlinecite{Noh2013}中计算结果为$\Omega_b=\frac{2}{p}$，有误。}和稳定性极限$\Omega_s$最大，分别为
\begin{equation}
\Omega_b=\sqrt{\frac{2}{p(1-p)}}\qquad \Omega_s=\frac{2}{\sqrt{(1-p)(1-3p)}}
\end{equation}
同时，根据不等式关系(\ref{eq:Noh17})可得$p$的取值范围为
\begin{equation}
\frac{1}{2}\le p\le\frac{2}{3}\label{eq:Nohp}
\end{equation}

进一步，若使用分岔点处的谱半径值$\rho_b$来刻画显式算法的耗散性能，则有下列关系\footnote{文\inlinecite{Noh2013}中结果为$p=\frac{2-\sqrt{2+2\rho_b}}{1-\rho_b}$，有误，原因是$\Omega_b$的计算错误导致。}成立
\begin{equation}
p=\frac{1}{1+\rho_b}\label{eq:Noh23}
\end{equation}

由等式(\ref{eq:Nohp})可知，分岔点处的谱半径值应满足$0.5\le\rho_b\le1$时。当$\rho_b=1$和$0.5$，该算法分别实现无耗散和最大的耗散特性，但不能实现$\rho_b=0$的渐进消弭特性。

于是该复合型子步的显式算法实际为单参数算法($p$或$\rho_b$)。各参数取值如下
\begin{equation}
\left\{\begin{aligned}
s&=-1\\
q_0&=\frac{2p-1}{2p}\\
q_1&=\frac{1-2p}{2p(1-p)}\\
q_2&=\frac{p}{2(1-p)}
\end{aligned}\right.
\end{equation}

\subsection{Kwon-Lee四子步算法}
Kwon和Lee等人\cite{Kwon2017}，基于四阶的中心差分格式和一个高阶导数项去最小化高频振动解，提出了一阶精度的四子步显式复合型算法。该算法将时间步长$\Delta t$分为相等的四个子步长$\Delta t/4$。

在第一个子步内使用
\begin{equation}
\begin{split}
M{^{t+\Delta t/4}\!\ddot{U}}+C{^{t+\Delta t/4}\!\dot{U}}+K{^{t+\Delta t/4}\!{U}}&={^{t+\Delta t/4}\!\hat{R}}\\
{^{t+\Delta t/4}\!U}&={^t\!U}+\frac{\Delta t}{4}{^t\!\dot{U}}+\frac12\left(\frac{\Delta t}{4}\right)^2{^t\!\ddot{U}}\\
{^{t+\Delta t/4}\!\dot{U}}&={^t\!\dot{U}}+\frac{\Delta t}{4}{^t\!\ddot{U}}
\end{split}
\end{equation}

在第二个子步内则使用
\begin{equation}
\begin{split}
M{^{t+\Delta t/2}\!\ddot{U}}+C{^{t+\Delta t/2}\!\dot{U}}+K{^{t+\Delta t/2}\!{U}}&={^{t+\Delta t/2}\!\hat{R}}\\
{^{t+\Delta t/2}\!U}&={^t\!U}+\frac{\Delta t}{2}{^{t+\Delta t/4}\!\dot{U}}+\frac12\left(\frac{\Delta t}{2}\right)^2{^{t+\Delta t/4}\!\ddot{U}}\\
{^{t+\Delta t/2}\!\dot{U}}&={^t\!\dot{U}}+\frac{\Delta t}{2}{^{t+\Delta t/4}\!\ddot{U}}
\end{split}
\end{equation}

在第三个子步内则使用
\begin{equation}
\begin{split}
M{^{t+3\Delta t/4}\!\ddot{U}}+C{^{t+3\Delta t/4}\!\dot{U}}+K{^{t+3\Delta t/4}\!{U}}&={^{t+3\Delta t/4}\!\hat{R}}\\
{^{t+3\Delta t/4}\!U}&={^{t+\Delta t/4}\!U}+\frac{\Delta t}{2}{^{t+\Delta t/2}\!\dot{U}}+\frac12\left(\frac{\Delta t}{2}\right)^2{^{t+\Delta t/2}\!\ddot{U}}\\
{^{t+3\Delta t/4}\!\dot{U}}&={^{t+\Delta t/4}\!\dot{U}}+\frac{\Delta t}{2}{^{t+\Delta t/2}\!\ddot{U}}
\end{split}
\end{equation}

最后，在第四个子步内使用
\begin{equation}
\begin{split}
M{^{t+\Delta t}\!\ddot{U}}+C{^{t+\Delta t}\!\dot{U}}+K{^{t+\Delta t}\!{U}}&={^{t+\Delta t}\!{R}}\\
{^{t+\Delta t}\!U}&=8{^{t+3\Delta t/4}\!U}-8{^{t+\Delta t/4}\!U}+{^t\!U}-3\Delta t{^{t+\Delta t/2}\!\dot{U}}+\alpha{^{t+\Delta t/2}\!U^{(4)}}(\Delta t)^4\\
{^{t+\Delta t}\!\dot{U}}&=8{^{t+3\Delta t/4}\!\dot{U}}-8{^{t+\Delta t/4}\!\dot{U}}+{^t\!\dot{U}}-3\Delta t{^{t+\Delta t/2}\!\ddot{U}}+\alpha{^{t+\Delta t/2}\!U^{(5)}}(\Delta t)^4
\end{split}
\end{equation}
其中$U^{(i)}$表示第$i$阶导数值。参数$\alpha$控制算法的稳定性和精度，其取值为$0.0409\le\alpha\le0.045$。同时${^{t+\Delta t/2}\!U^{(4)}}$和${^{t+\Delta t/2}\!U^{(5)}}$分别由
\begin{align}
{^{t+\Delta t/2}\!U^{(4)}}&=\frac{{^{t+3\Delta t/4}\!\dot{U}}-3{^{t+\Delta t/2}\!\dot{U}}+3{^{t+\Delta t/4}\!\dot{U}}-{^{t}\!\dot{U}}}{(\Delta t)^3/32}\\
{^{t+\Delta t/2}\!U^{(5)}}&=\frac{{^{t+3\Delta t/4}\!\ddot{U}}-3{^{t+\Delta t/2}\!\ddot{U}}+3{^{t+\Delta t/4}\!\ddot{U}}-{^{t}\!\ddot{U}}}{(\Delta t)^3/32}
\end{align}

上述算法中的外荷载项在$t+i\Delta/4,i=1,2,3,4$时刻的计算公式如下
\begin{equation}
\left\{
\begin{aligned}
{^{t+\Delta t/4}\!\hat{R}}&=\frac{1}{4}(3{^t\!R}+{^{t+\Delta t}\!R})\\
{^{t+\Delta t/2}\!\hat{R}}&=\frac{1}{2}({^t\!R}+{^{t+\Delta t}\!R})\\
{^{t+3\Delta t/4}\!\hat{R}}&=\frac{1}{4}({^t\!R}+3{^{t+\Delta t}\!R})
\end{aligned}\right.
\end{equation}

\section{本章小结}

